<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Link to Bootstrap-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel = "stylesheet" type = "text/css" href = "/style.css">

    <title>Friend Survey</title>
</head>


<body>

    <div class = "container">
        <div class = "row space"></div>
        <header class = "row">
            <div class = "col-12">
                <h2>Survey Questions</h2>


            </div>
        </header>
        <hr>
        
        <div class = "row">
            <div class = "col-12">
                
                <h3>About You</h3>

                <form>
                    <div class = "form-group">
                        <label for = "username">Name (Required)</label>
                        <input type = "text" class = "form-control" id = "username">
                    </div>
        
                    <div class = "form-group">
                        <label for = "photoLink">Link to Photo Image (Required)</label>
                        <input type = "text" class = "form-control" id = "photoLink">
                    </div>
                </form>

            </div>
        </div>

        <hr>

        <div class = "row">
            <div class = "col-12">
                <h3>Questions</h3>
                <p>Note: 1 => Strongly Disagree, 5 => Strongly Agree</p>
            </div>
        </div>

        <div class="row space"></div>



        <!-- Question 1 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 1</h4>
                <p>You like to try new things.</p>
                
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question1Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
        </div>

        <div class = "row space"></div>


        <!-- Question 2 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 2</h4>
                <p>Test</p>
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question2Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>

            </div>
        </div>

        <div class = "row space"></div>

        <!-- Question 3 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 3</h4>
                <p>This is a test</p>
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question3Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
        </div>

        <div class = "row space"></div>


        <!-- Question 4 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 4</h4>
                <p>This is a test</p>
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question4Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
        </div>

        <div class = "row space"></div>


        <!-- Question 5 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 5</h4>
                <p>This is a test</p>
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question5Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
        </div>

        <div class = "row space"></div>


        <!-- Question 6 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 6</h4>
                <p>This is a test</p>
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question6Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
        </div>

        <div class = "row space"></div>


        <!-- Question 7 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 7</h4>
                <p>This is a test</p>
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question7Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
        </div>

        <div class = "row space"></div>


        <!-- Question 8 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 8</h4>
                <p>This is a test</p>
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question8Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
        </div>

        <div class = "row space"></div>


        <!-- Question 9 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 9</h4>
                <p>This is a test</p>
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question9Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
        </div>

        <div class = "row space"></div>


        <!-- Question 10 -->

        <div class = "row">
            <div class = "col-12">
                <h4>Question 10</h4>
                <p>This is a test</p>
            </div>
        </div>

        <div class = "row">
            <div class = "col-2">
                <select class = "form-control" id = "question10Answer">
                    <option selected disabled>Choose...</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
        </div>

        <div class = "row space"></div>
        <div class = "row space"></div>

        <div class = "row">
            <div class = "col-12">
                <input type="submit" onclick = "getUserInfo()" class = "btn btn-primary btn-block btn-lg submit" value = "Submit Form">
            </div>
        </div>

        <div class = "row space"></div>
        <div class = "row space"></div>




    </div>

    <!-- Link to jQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Link to friends.js -->
    <script type = "text/javascript" src = "../data/friends.js"></script>

</body>

<script type = "text/javascript">

    // function displayFriendData() {
    //     var currentURL = window.location.origin;

    //     $.ajax({url: currentURL + "/api/friends", method: "GET"})
    //     .then(function(response) {
    //         // var results = response.data;
    //         // console.log(results);

    //         console.log(response);
    //     })
    // }

    // displayFriendData();

    // var friendFile = require("./data/friends.js");
    // console.log(typeof friendFile.Friend);
    // var Friend = friendFile.Friend;
    // var friendArray = friendFile.friendArray;


    var questionArray = [];
    var userArray = [];

    var currentURL = window.location.origin;
    var username;
    var photoURL;

    var diffArray = [];
    var sum = 0;


    // This function will grab the user's form data and put the data into "userArray"
    function getUserInfo() {


        for (i = 1; i < 11; i++) {
            var question = "#question" + i + "Answer";
            // var question
            questionArray.push(question);
            userArray.push(parseInt($(questionArray[i-1]).val()));
        }



        username = $("#username").val();
        photoURL = $("#photoLink").val();

        function Friend (name, photo, scores) {
            this.name = name;
            this.photo = photo;
            this.scores = scores;

        }

        var newUser = new Friend(username, photoURL, userArray);
        // console.log(newUser);

        findMatch(newUser);

        // console.log(newUser);

    

    }

    // console.log(questionArray);

    // getUserInfo();

    // $(".submit").on("click", getUserInfo());

    // var newUser = new Friend()


    function findMatch(newUser) {

        /* 
        
        I need to make a function that takes the difference betweent the user's scores and 
            the friends' scores.

        1. Start with the newUser object.
        2. Compare with each friend in the friendArray
            a. For each item in the scores array, take the absolute value of their difference
            b. Store this value in an array.
        3. Take the sum of the array in 2b.
        4. Add the total(s) as different properties of the user's object.
        

        */


        $.get(currentURL + "/api/friends", function(data, status) {

            for (i = 0; i < data.length; i++) {
                console.log(data);

                console.log("=========================");

                // loop through array items
                for (j = 0; j < newUser.scores.length; j++) {
                    diffArray[j] = Math.abs(newUser.scores[j] - data[i]['scores[]'][j]);

                }


                console.log("Loop " + i);

                console.log(diffArray);


                for (j = 0; j < diffArray.length; j++) {
                    sum += diffArray[j];
                }

                newUser[`totalDiff${i}`] = sum;

                console.log(sum);
                sum = 0;

            }
            

            // for (i = 0; i < 5; i++) {
            //     newUser[`totalDiff${i}`] = i;
            // }
        })
        .then(function() {
            $.post(currentURL + "/api/friends", newUser, function(data) {
                console.log(data);
            });
        })

        
       
    }

    // function getSum(array) {
    //     // var sum = 0;
    //     for (i = 0; i < array.length; i++) {
    //         sum += array[i];
    //     }

    //     // return sum;
    // }




</script>
</html>